---
layout: post
tags: system
title: Tricard - Malware sanboxes fingerprinting
---

Introduction to malware sandboxes fingerprinting


{:refdef: style="text-align: center;"}
![_config.yml]({{ site.base}}/images/tricard/tricard.jpg)
{: refdef}

# TLDR;

> &rarr; Security software: I will protect your system and defend against malicious activity!<br>
> &rarr; Malware: I will detect and evade your defenses!<br>
> &rarr; Security software: I will then detect your detection mechanisms!<br>
> &rarr; Malware: I will .. uh.. <br>



{:refdef: style="text-align: center;"}
![_config.yml]({{ site.base}}/images/tricard/spiderman_meme.jpg)
{: refdef}

# Table of contents:



# 1. Compile and dispatch
All data is concatenated in a JSON array. As it can be very heavy very quickly, the JSON payload POST requests are compressed using Zlib. The client and server are configured to communicate over HTTPS.
# 1.1 Collector functions

### 1. ListProcessesToJson(char* jsonData, size_t jsonDataLen):
- **Overview:**
  - Lists running processes on the system and appends process information to a JSON-formatted string.
  - Process information includes process ID, parent process ID, executable name, and command line.
  - JSON data is stored in the provided `jsonData` buffer.
- **Prototype:**
  ```cpp
  void ListProcessesToJson(char* jsonData, size_t jsonDataLen)
```

# 1.2 JSON Structure
# 1.3 Compiled binaries
# 2. Examples
# 3. Server setup
# 3.1 Registering a new tricard sample
{:refdef: style="text-align: center;"}
![_config.yml]({{ site.base}}/images/tricard/uuid_match.jpg)
{: refdef}
# 3.2 JSON samples database


Stay classy netsecurios, and happy Rememberance Day!

---
November 2023
---
