---
layout: post
tags: system web
title: OSCP tips and tricks
---

A summary of my notes during the OSCP labs and certification. I also decided to add a few tips I use for actual engagements (red team, pentest, and a bit of reversing). A lot of the commands, tools, and tips come from other online guides (OSCP related or not), they are linked at the bottom of this post.

<div style="text-align: center;">
 <a href="/tags#system"><img src="{{ site.baseurl }}/icons/system.png" width="200" title="system" ></a>
 <a href="/tags#crypto"><img src="{{ site.baseurl }}/icons/web.png" width="200" title="crypto" ></a>
</div>

How to pwn OSCP labs and exams ! (100 + 10 / 100 points)

{:refdef: style="text-align: center;"}
![_config.yml]({{ site.baseurl }}/images/PEN-200-course-icon.png)
{: refdef}

# TLDR;

> Enumerate through thorough scans, do not overlook even the tiniest detail.<br>
> Go breadth first, always.<br>
> It's ok to fall in rabbit holes, proceed by elimination.<br>
> If you already are a skilled professional, it's ok to find some of the lab boxes hard. In fact, a few of them rely more on CTF style riddles than actual penetration testing logic.<>br
> Do not underestimate the power of morale during the exam. Sugar, tee, coffee, sleep, r00t (going for low hanging fruits will boost your confidence). <br>


# Part 1: General Methodolgy

I can't emphasize enough on this, breadth first. Always. I've found myself digging in rabbit holes more times than I can count. And being as stubborn as a mule, I have sent literal days working on pointless exploits, when a simple *searchsploit -m* on another port I even had scanned, would instantly give me an initial foothold.

{:refdef: style="text-align: center;"}
![_config.yml]({{ site.baseurl }}/images/OSCP/graph.webp)
{: refdef}

The idea is:

* Note everything that comes to your mind when discovering the challenge (names, ports, services, nothing is done randomly and a lot of those are actual hints).
* Scan everything.
* Google every known protocol or port and version identified (you might find very easily exploitable processes).
* Once you are certain you have covered everything thats open, start digging more deeply.
* After doing that, you should follow your intuition (that little bell that rings at the end of the first scan, saying "hoo this is open ??? **nice.**") and try the leads you thought were the best ones initially.
* If and once you have proven your intuition *wrong*, you can start proceeding by elimination and go through all potential leads, one by one.

# Part 2: Information Gathering

For the labs and exam, I applied the same method over and over, and always obtained good results (except for UDP of course but what an annoying procotol).

## Ping Sweep

```bash
#! /bin/bash
for ip in $(seq 1 256); do
 fping -c 1 -t 500 $1.$ip 2>&1 |grep max|cut -d ':' -f1|tr -d ' '
done
```

## 3 steps (4 if UDP) scanning process

Of course you could use [Nmap automator]([url](https://github.com/21y4d/nmapAutomator)), but if you want to do things manually, here is my way:

```bash
# Get all ports
nmap -p- -T5 -Pn <IP>|grep open|awk '{print $1}'|cut -d '/' -f1|tr '\n' ','
```
This should give you a nmappable list of ports like 80,443,3389,10069.

```
# Fingerprinting scan
sudo nmap -p <port list> -T5 -A -R -O <IP> -Pn
```

Although it might be a bit redundant with the next step, it is much quicker, and will give you something to work on while the last scan runs.

```
# Script scan
nmap -p <port list> -T5 -sV --version-all --script default,auth,brute,discovery,vuln <IP> -Pn
```

This one is not very subtle, but it **will** find a lot of interesting information, at no cost. You might find things like:

* FTP authentication (very often anonymous)
* SSH weak credentials
* SMB user names and local information
* Known exploits (not very accurate but it has worked a few times in the lab)


