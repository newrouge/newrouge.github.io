---
layout: post
title: Reversing TL-WR840N
---
Buying cheap routers to find vulnerabilities in them

{:refdef: style="text-align: center;"}
![_config.yml]({{ site.baseurl }}/images/tplink/router.jpg)
{: refdef}

# Part 1: Acquiring the firmware
TP Link firmwares are easy to get as they are free to download online:
https://www.tp-link.com/in/support/download/tl-wr840n/
But that is a bit too easy isn't it ? Is there another way to get it ?
{:refdef: style="text-align: center;"}
![_config.yml]({{ site.baseurl }}/images/tplink/serial.jpg)
{: refdef}

Most of these devices have a serial port for debugging. Connecting to it should be trivial using a USB to UART adapter:

{:refdef: style="text-align: center;"}
![_config.yml]({{ site.baseurl }}/images/tplink/usbuart.jpg)
{: refdef}

Using this, you could potentially interrupt the boot sequence and enter a low-level shell that would allow you to do things like read the EEPROM chip at different offsets. Of course, if the goal is to easily get the firmware (over several hours because of the baud rate), then you've won !
But, still no thanks. I wanted to try something new:

{:refdef: style="text-align: center;"}
![_config.yml]({{ site.baseurl }}/images/tplink/desolder.jpg)
{: refdef}

Desoldering the EEPROM that contains the firmware was my way. If you are looking for a good reason to chose this way rather than any of the aformentioned ones, there isn't. I had just recently acquired a TL866II+, and wanted to have fun with it !
So the chip perfectly fits in the 200mm SOP8 adapter:

{:refdef: style="text-align: center;"}
![_config.yml]({{ site.baseurl }}/images/tplink/tl866.jpg)
{: refdef}

But before being able to read from it, we need to identify which kind of chip it is:

{:refdef: style="text-align: center;"}
![_config.yml]({{ site.baseurl }}/images/tplink/eeprom.jpg)
{: refdef}

We can read AH1903 25Q32CS1G, and the logo is Giga Device.
By looking for GD25Q32 in the list of devices supported by minipro, we get this: GD25Q32 @SOP8

